-- 테이블을 변경하는 ALTER : 테이블에 새 열을 추가, 삭제하거나 열의 자료형 또는 길이 변경
CREATE TABLE EMP_ALTER
	AS SELECT * FROM EMP;
SELECT * FROM EMP_ALTER;

-- ALTER에 ADD : 컬럼을 추가
ALTER TABLE EMP_ALTER
	ADD HP VARCHAR(20);
SELECT * FROM EMP_ALTER;

-- ALTER에 RENAME : 열 이름을 변경
ALTER TABLE EMP_ALTER
	RENAME COLUMN HP TO TEL;
	
-- ALTER에 MODIRY : 열의 자료형을 변경
ALTER TABLE EMP_ALTER
	MODIFY EMPNO NUMBER(5); -- 크기를 크게 하는건 가능

ALTER TABLE EMP_ALTER 
	MODIFY TEL VARCHAR(18); -- 크기를 줄였지만 영향 받는 해당 컬럼에 대한 데이터가 영향 받지 않음
	
-- ALTER에 DROP : 특정 열을 삭제 할 때
ALTER TABLE EMP_ALTER
	DROP COLUMN COMM;

-- 테이블 이름 변경 : RENAME
RENAME EMP_ALTER TO EMP_RENAME;
SELECT * FROM EMP_RENAME;	
	
-- 테이블 데이터를 삭제하는 TRUNCATE
TRUNCATE TABLE EMP_RENAUME; -- ROLLBACK 안됨
DELETE FROM EMP_RENAME; -- ROLLBACK 가능 
	
-- 테이블을 삭제하는 DROP
DROP TABLE EMP_RENAME;

CREATE TABLE TABLE_NOTNULL(
	LOGIN_ID VARCHAR2(20) NOT NULL,
	LOGIN_PWD VARCHAR2(20) NOT NULL,
	TEL VARCHAR2(20)
);

INSERT INTO TABLE_NOTNULL VALUES('AJY0811', 'JY123456789' , NULL);
SELECT * FROM TABLE_NOTNULL;	

-- UPDATE는 DML이며 열의 데이터를 수정
UPDATE TABLE_NOTNULL
	SET TEL = '010-4129-4821'
	WHERE LOGIN_ID = 'AJY0811';
	
ALTER TABLE TABLE_NOTNULL
	MODIFY TEL NOT NULL;
	
-- 중복 값을 허용하지 않는 UNIQUE
CREATE TABLE TABLE_UNIQUE(
	LOGIN_ID VARCHAR2(20) PRIMARY KEY, -- UNIQUE와 NOT NULL 조건 같이 들어감
	LOGIN_PWD VARCHAR2(20) NOT NULL,
	TEL VARCHAR2(20)
);

INSERT INTO TABLE_UNIQUE VALUES('고길동', 'GD1234','010-1234-5678'); 
INSERT INTO TABLE_UNIQUE VALUES('둘리', 'GD1634','010-1234-5678');
INSERT INTO TABLE_UNIQUE VALUES(NULL, 'GD1634','010-1234-56718');
SELECT * FROM TABLE_UNIQUE; 
	
DROP TABLE TABLE_UNIQUE;

-- 다른 테이블과 관계를 맺는 FOREIGN KEY(외래키)
-- 외래키는 서로 다른 테이블과 관계를 정의 하는데 사용하는 제약 조건	
-- 참조하고 있는 기본키의 데이터 타입과 일치해야 하며, 외래키에 참조되고 있는 기본키는 삭제 할 수 없음
CREATE TABLE DEPT_FK(
	DEPTNO NUMBER(2) PRIMARY KEY,
	DNAME VARCHAR2(14),
	LOC VARCHAR2(13)
);
DROP TABLE DEPT_FK;

CREATE TABLE EMP_FK(
	EMPNO NUMBER(4) PRIMARY KEY,
	ENAME VARCHAR2(10),
	JOB VARCHAR2(9),
	MGR NUMBER(4),
	HIREDATE DATE,
	SAL NUMBER(7,2),
	COMM NUMBER(7,2),
	DEPTNO NUMBER(2) REFERENCES DEPT_FK(DEPTNO)
);
INSERT INTO DEPT_FK VALUES(10, '둘리친구','SEOUL');
INSERT INTO DEPT_FK VALUES(20, '둘리친구','SEOUL');

INSERT INTO EMP_FK VALUES(9000, '도우너', '루돌프', 8000, SYSDATE, 1000, 300, 10);
INSERT INTO EMP_FK VALUES(9001, '또치', '타조', 7000, SYSDATE, 2000, 700, 20);

SELECT * FROM EMP_FK;
SELECT * FROM DEPT_FK;

DELETE FROM EMP_FK
	WHERE DEPTNO = 20;

DELETE FROM DEPT_FK
	WHERE DEPTNO = 20;
